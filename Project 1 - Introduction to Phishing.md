## ðŸ§  Introduction

The **Introduction to Phishing** lab on **TryHackMeâ€™s SOC Simulator** is designed to familiarize analysts with the core workflow of detecting, analyzing, and responding to phishing-based alerts in a simulated enterprise SOC environment.  

In this scenario, I acted as a **Tier 1 SOC Analyst**, responsible for investigating an **inbound phishing email alert** detected by the organizationâ€™s SIEM. The objective was to understand how phishing indicators appear in security logs, how to validate the alert, and how to document findings for escalation or closure.  

The simulation environment includes realistic SOC tools such as:
- A **Splunk dashboard** for alert management and log correlation  
- **Email analysis utilities** to inspect headers, attachments, and URLs  
- **Analyst VM** for executing sandbox or open-source intelligence (OSINT) checks  

The first step in the investigation began with reviewing the SOC Simulator dashboard, where a **new alert** appeared under the *â€œIntroduction to Phishingâ€* scenario. The screenshot below shows the initial alert summary generated by the SIEM.

---

![Introduction to Phishing â€“ Initial Alert](https://github.com/Balasankkar/SOC-Analyst-Lab-Series-TryHackMe/blob/8c9a444bfd39f7cf1be450daf25cd67c67935752/Screenshots/Screenshot%201.png)
*Figure 1 â€” Initial alert detected in SOC Simulator: â€œInbound Email Containing Suspicious External Linkâ€*

## ðŸ§© Alert Triage and Initial Analysis

Once the phishing alert appeared in the Splunk dashboard, the next step was to move to the **Alert Queue** to review the details and validate its legitimacy.  
The alert was titled **â€œInbound Email Containing Suspicious External Linkâ€** with a **Medium severity** rating and categorized under **Phishing**.

At this stage, I opened the alert to examine its key attributes, including the **subject line**, **sender domain**, **recipient address**, **message content**, and **embedded URL**. The alert description indicated that it was triggered by an **inbound email containing one or more external links** flagged as potentially suspicious by the SIEMâ€™s detection rule.

---

### ðŸ§¾ Alert Metadata
| Field | Details |
|-------|----------|
| **Alert ID** | 8814 |
| **Severity** | Medium |
| **Type** | Phishing |
| **Timestamp** | 2025-11-25 03:37:23 UTC |
| **Subject** | *Action Required: Finalize Your Onboarding Profile* |
| **Sender** | `onboarding@hrconnex.thm` |
| **Recipient** | `j.garcia@thetrydaily.thm` |
| **Attachment** | None |
| **Direction** | Inbound |
| **Alert Status** | Awaiting Action â†’ Assigned to self |

---

### ðŸ•µï¸ Observations

- The **subject line** contains urgent language (â€œAction Requiredâ€), which is a **common phishing indicator** used to create a sense of urgency and prompt users to act quickly.  
- The **sender domain** (`hrconnex.thm`) mimics a legitimate HR-related domain but differs slightly from the recipientâ€™s organization domain (`thetrydaily.thm`), which raises suspicion.  
- The **body of the email** includes a link labeled â€œSet Up My Profile,â€ which leads to a domain-hosted path `https://hrconnex.thm/onboarding/15400654060/j.garcia`.  
- No attachments were present, indicating this is a **URL-based phishing attempt** rather than an attachment-based one.  
- The SIEM rule suggests verifying whether any endpoints attempted to access the URL â€” the next step in confirming whether the threat was acted upon.

---

After reviewing these details, I **assigned the alert to myself** to proceed with deeper analysis and validation, following SOC standard operating procedures for alert ownership and tracking.

---

![Splunk Alert Queue â€” Phishing Alert Details](https://github.com/Balasankkar/SOC-Analyst-Lab-Series-TryHackMe/blob/8c9a444bfd39f7cf1be450daf25cd67c67935752/Screenshots/Screenshot%202.png)
*Figure 2 â€” Alert queue in Splunk showing phishing alert details and metadata before investigation.*

## ðŸ§® Log Analysis in Splunk

After assigning the phishing alert to myself, the next step was to perform **log analysis** in **Splunk** to gather more context about the suspicious sender and verify the scope of the potential phishing activity.  

Using Splunkâ€™s search query interface, I filtered the logs by the **sender email address**:


This allowed me to view all email events associated with the sender within a **two-hour time window** surrounding the initial alert.  

---

### ðŸ” Findings

- Only **two email events** were found in Splunk related to `onboarding@hrconnex.thm`.  
- Both messages were sent to the **same recipient**, `j.garcia@thetrydaily.thm`,  
- The **email content** in both instances was identical:
  > *"Action Required: Finalize Your Onboarding Profile"*
- The embedded link inside both messages pointed to the same suspicious domain:

![Splunk Search â€” Email Log Analysis](https://github.com/Balasankkar/SOC-Analyst-Lab-Series-TryHackMe/blob/8c9a444bfd39f7cf1be450daf25cd67c67935752/Screenshots/Screenshot%203.png)
*Figure 3 â€” Splunk search results showing two inbound emails sent from `onboarding@hrconnex.thm` within the past two hours.*

## ðŸ§© Correlating Events and Identifying Involved Users

After confirming that the phishing email originated from `onboarding@hrconnex.thm`, I expanded the investigation in **Splunk** to search for other related events within the same time frame.  
This step helps determine whether the phishing attempt caused any internal communications or further compromise.

---

### ðŸ•µï¸ Splunk Event Correlation

During the search, I discovered an internal email thread involving two employees:

- **Sender:** `h.harris@thetrydaily.thm`  
- **Recipient:** `j.carter@thetrydaily.thm`  
- **Subject:** *Unable to Receive Onboarding Email from hrconnex.thm*  

In this message, **Hannah Harris** from the HR department reached out to **Jacob Carter** from IT support, mentioning that **Julia Garcia**, a new hire, hadnâ€™t received her onboarding email from **hrconnex.thm** â€” the same domain identified in the phishing alert.

---

![Splunk Events â€” Internal Discussion About Missing Onboarding Email](https://github.com/Balasankkar/SOC-Analyst-Lab-Series-TryHackMe/blob/8c9a444bfd39f7cf1be450daf25cd67c67935752/Screenshots/Screenshot%204.png)
*Figure 4 â€” Splunk logs showing internal communication referencing the suspicious hrconnex.thm domain.*

---

### ðŸ§¾ Verification Through Company Documentation

To confirm the identities and roles of the individuals mentioned in the internal emails, I accessed the **Company Documentation** section in the SOC Simulator.  
This documentation contains employee details, including names, departments, email addresses, and assigned workstations.

From the database:
- **Hannah Harris** â€” Human Resources (`h.harris@thetrydaily.thm`)  
- **Jacob Carter** â€” IT Support (`j.carter@thetrydaily.thm`)  
- **Julia Garcia** â€” Content Department (`j.garcia@thetrydaily.thm`)

This cross-verification validated that all three are legitimate internal employees.

---

![Company Documentation â€” Employee Directory](https://github.com/Balasankkar/SOC-Analyst-Lab-Series-TryHackMe/blob/8c9a444bfd39f7cf1be450daf25cd67c67935752/Screenshots/Screenshot%205.png)
*Figure 5 â€” Company documentation verifying the roles of users involved in the phishing incident.*

---

## ðŸ§ª URL and Domain Analysis

After correlating the phishing-related events in Splunk and verifying the internal employee communications, the next step was to determine whether the suspicious URL in the phishing email was indeed malicious or a false positive.  

To safely perform this check, I switched to the **Analyst VM** provided within the TryHackMe SOC Simulator. The Analyst VM serves as a **sandboxed investigation environment**, allowing analysts to execute scripts, analyze links, or inspect attachments without exposing the live network to potential threats.

---

### ðŸ§° Environment Setup

Inside the Analyst VM, I found a built-in analysis utility called **TryDetectThis** â€” a simulated version of a URL and file reputation checker.  
This tool is designed to assess domains, URLs, or files for known indicators of compromise (IoCs), malicious behavior, or suspicious patterns.

The screenshot below shows the Analyst VM environment before beginning the analysis.

![Analyst VM Environment](https://github.com/Balasankkar/SOC-Analyst-Lab-Series-TryHackMe/blob/8c9a444bfd39f7cf1be450daf25cd67c67935752/Screenshots/Screenshot%206.png)
*Figure 6 â€” Analyst VM within the SOC Simulator, prepared for controlled URL inspection.*

---

### ðŸ” URL Reputation Check

Using **TryDetectThis**, I entered the suspicious URL extracted from the email:


The URL/IP security check was executed to determine if the domain `hrconnex.thm` was known for malicious behavior or phishing activity.

**Result:**  
> âœ… **URL/IP Analysis Complete â€” Status: CLEAN**

No malicious indicators or reputation warnings were detected for this domain.

![TryDetectThis â€” URL Analysis Result](https://github.com/Balasankkar/SOC-Analyst-Lab-Series-TryHackMe/blob/8c9a444bfd39f7cf1be450daf25cd67c67935752/Screenshots/Screenshot%207.png)
*Figure 7 â€” TryDetectThis URL scan result showing the link as clean.*

---

### ðŸ§  Analysis Notes

- The alert was initially triggered due to **phishing-like characteristics**:  
  - Urgent tone in subject line (â€œAction Requiredâ€).  
  - External link in an inbound message.  
  - Sender from a non-corporate domain (`hrconnex.thm`).
- However, **reputation analysis confirmed** that the URL was clean and not associated with known phishing infrastructure.  
- The investigation further verified that `hrconnex.thm` is a legitimate HR partner domain used by the organization for onboarding new hires.  
- Based on this evidence, the alert was reclassified as a **False Positive (FP)**.

---

## ðŸ§¾ Incident Closure and Summary Report

After completing the investigation, all available evidence indicated that the alert was a **False Positive**.  
The phishing alert initially raised by the SIEM was caused by an **inbound email containing an external link**. However, no malicious activity was identified upon further verification.

---

### ðŸ•’ Time of Activity
- **Date/Time:** November 25, 2025 â€“ 03:37:23 UTC  
- **Event Summary:**  
  A user, `j.garcia@thetrydaily.thm`, received an email from `onboarding@hrconnex.thm` containing a link to complete onboarding documentation.  
  The SIEM flagged the message due to the presence of an external domain (`hrconnex.thm`) and keywords suggesting urgency.

---

### ðŸ‘¥ Related Entities
| Type | Entity |
|------|--------|
| **Sender** | `onboarding@hrconnex.thm` |
| **Recipient** | `j.garcia@thetrydaily.thm` |
| **Analyst** | Balasankkar |
| **Tools Used** | Splunk (SIEM), TryDetectThis (URL Analysis), Analyst VM |

---

### ðŸ§  Investigation Summary
1. **Alert Review:**  
   The initial alert in Splunk indicated a suspicious inbound email with an external link, categorized under â€œPhishing.â€

2. **Log Analysis:**  
   - Reviewed all emails from the sender `onboarding@hrconnex.thm`.  
   - Found only two instances of outbound messages â€” both sent to the same recipient (`j.garcia@thetrydaily.thm`) within the last two hours.  
   - No additional recipients or lateral communications were detected.

3. **Context Correlation:**  
   - Identified internal communication between `h.harris@thetrydaily.thm` (HR) and `j.carter@thetrydaily.thm` (IT) referencing the onboarding process.  
   - Verified via company documentation that both users were legitimate employees, confirming that the sender domain might belong to a trusted HR partner.

4. **URL Analysis:**  
   - The suspicious link `https://hrconnex.thm/onboarding/15400654060/j.garcia` was analyzed in a sandboxed environment using **TryDetectThis**.  
   - Result: âœ… *URL/IP Analysis Complete â€” Status: CLEAN*  
   - No malware or malicious indicators detected.  

5. **User Interaction Check:**  
   - Confirmed that the recipient (`j.garcia`) did **not click the link**, preventing any potential compromise.

---

### ðŸ§© Classification
> **Final Verdict:** False Positive  

**Rationale:**  
- The sender domain was verified and found legitimate.  
- No malicious artifacts or indicators were found in Splunk or the sandbox analysis.  
- The email content and sender were confirmed as part of a real onboarding process.  
- The SIEM correctly flagged the message based on pattern rules, but the context proved it was non-malicious.

---

![SOC Simulator â€“ Case Report Submission](https://github.com/Balasankkar/SOC-Analyst-Lab-Series-TryHackMe/blob/8c9a444bfd39f7cf1be450daf25cd67c67935752/Screenshots/Screenshot%208.png)
*Figure 8 â€” Case report form in TryHackMe SOC Simulator showing alert closure as False Positive.*

---

### âœ… Lessons Learned
- Contextual analysis is essential before escalating alerts.  
- Even legitimate emails can mimic phishing characteristics, so analysts must verify through **domain reputation** and **internal context**.  
- Documenting closure rationale ensures transparency and strengthens SOC reporting quality.

---

### ðŸ§© Final Outcome
The alert was closed as a **False Positive** after thorough review and documented in the **SOC Simulator Case Report**.  
This exercise demonstrates a complete Tier 1 SOC workflow â€” from alert triage to analysis, verification, and reporting.

---





